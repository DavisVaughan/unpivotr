---
title: "Examples"
author: "Ian Moran"
date: "28/04/2019"
output:   
  html_document
editor_options: 
  chunk_output_type: console
---


```{r message=FALSE, warning=FALSE, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(tibble.print_min = 100, tibble.print_max = 100)
options(width=100)
```

```{r}
setwd("C:/Users/Ian/Data/r-projects/unpivotr-dev/unpivotr/vignettes")
home_dir <- rprojroot::find_package_root_file()
```




#### Setup packages 
```{r message=FALSE, warning=FALSE, include=FALSE}
library(devtools)
devtools::load_all(home_dir)

# install_github("nacnudus/unpivotr",ref = "ian")
library(unpivotr)
library(rprojroot)
library(magick)
library(magrittr)
library(tidyverse)
library(tidyxl)
library(stringr)
```

## Spreadsheets from worked-examples.xlsx

#### clean


```{r echo=FALSE, fig.height=8, fig.width=12, message=FALSE, warning=FALSE}
magick::image_read("https://unpivotr.s3.amazonaws.com/worked-examples_clean.png")
```


```{r message=FALSE, warning=FALSE}
devtools::load_all(home_dir)

unpivotr_example()

unpivotr::fmt_font


workbook_path <- unpivotr_example("newresconst.xlsx")
sheet_name <- "Table 1 - Permits"

testsheet_df <- xlsx_cells(path = workbook_path, sheets = sheet_name)
formats <- xlsx_formats(workbook_path)



orientated_df_auto <-  orientate_auto(sheet = testsheet_df,formats = formats,
                                      manual_value_references = "B9:M30",
                                      group_row_headers_by = 
                                        list(fmt_alignment_indent,fmt_font_bold, ~ data_type == "numeric"),
                                      col_header_fill = "style")

orientated_df_auto %>% plot_orientations()

```


```{r}


```


