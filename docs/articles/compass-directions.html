<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Compass Directions • unpivotr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google analytics --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45097885-5', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">unpivotr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/compass-directions.html">Compass Directions</a>
    </li>
    <li>
      <a href="../articles/html.html">HTML Tables</a>
    </li>
    <li>
      <a href="../articles/small-multiples.html">Small Multiples</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nacnudus/unpivotr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Compass Directions</h1>
                        <h4 class="author">Duncan Garmonsway</h4>
            
            <h4 class="date">2017-11-26</h4>
          </div>

    
    
<div class="contents">
<p>This vignette for the <a href="https://github.com/nacnudus/unpivotr">unpivotr</a> package demonstrates unpivoting pivot tables of various kinds imported from a spreadsheet via the <a href="https://github.com/nacnudus/tidyxl">tidyxl</a> package. It is best read with the spreadsheet open in a spreadsheet program, e.g. Excel, LibreOffice Calc or Gnumeric.</p>
<p>The spreadsheet is in the package directory at <code>system.file("extdata", "purpose.xlsx", package = "unpivotr")</code>.</p>
<pre class="sourceCode r" id="cb1"><code class="sourceCode r"><div class="sourceLine" id="cb1-1" data-line-number="1">
<span class="kw">library</span>(dplyr)</div></code></pre>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="sourceCode r" id="cb5"><code class="sourceCode r"><div class="sourceLine" id="cb5-1" data-line-number="1">
<span class="kw">library</span>(tidyxl)</div>
<div class="sourceLine" id="cb5-2" data-line-number="2">
<span class="kw">library</span>(unpivotr)</div></code></pre>
<pre><code>## 
## Attaching package: 'unpivotr'</code></pre>
<pre><code>## The following object is masked from 'package:stats':
## 
##     offset</code></pre>
<div id="nnw-wnw-example" class="section level2">
<h2 class="hasAnchor">
<a href="#nnw-wnw-example" class="anchor"></a>NNW WNW example</h2>
<pre class="sourceCode r" id="cb8"><code class="sourceCode r"><div class="sourceLine" id="cb8-1" data-line-number="1">(original &lt;-<span class="st"> </span>purpose<span class="op">$</span><span class="st">`</span><span class="dt">NNW WNW</span><span class="st">`</span>)</div></code></pre>
<pre><code>##                            X2      X3     X4     X5    X6     X7
## 1                        &lt;NA&gt;    &lt;NA&gt; Female   &lt;NA&gt;  Male   &lt;NA&gt;
## 2                        &lt;NA&gt;    &lt;NA&gt;  0 - 6 7 - 10 0 - 6 7 - 10
## 3           Bachelor's degree 15 - 24   7000  27000  &lt;NA&gt;  13000
## 4                        &lt;NA&gt; 25 - 44  12000 137000  9000  81000
## 5                        &lt;NA&gt; 45 - 64  10000  64000  7000  66000
## 6                        &lt;NA&gt;     65+   &lt;NA&gt;  18000  7000  17000
## 7                 Certificate 15 - 24  29000 161000 30000 190000
## 8                        &lt;NA&gt; 25 - 44  34000 179000 31000 219000
## 9                        &lt;NA&gt; 45 - 64  30000 210000 23000 199000
## 10                       &lt;NA&gt;     65+  12000  77000  8000 107000
## 11                    Diploma 15 - 24   &lt;NA&gt;  14000  9000  11000
## 12                       &lt;NA&gt; 25 - 44  10000  66000  8000  47000
## 13                       &lt;NA&gt; 45 - 64   6000  68000  5000  58000
## 14                       &lt;NA&gt;     65+   5000  41000  1000  34000
## 15           No Qualification 15 - 24  10000  43000 12000  37000
## 16                       &lt;NA&gt; 25 - 44  11000  36000 21000  50000
## 17                       &lt;NA&gt; 45 - 64  19000  91000 17000  75000
## 18                       &lt;NA&gt;     65+  16000 118000  9000  66000
## 19 Postgraduate qualification 15 - 24   &lt;NA&gt;   6000  &lt;NA&gt;   &lt;NA&gt;
## 20                       &lt;NA&gt; 25 - 44   5000  86000  7000  60000
## 21                       &lt;NA&gt; 45 - 64   6000  55000  6000  68000
## 22                       &lt;NA&gt;     65+   &lt;NA&gt;  13000  &lt;NA&gt;  18000</code></pre>
<pre class="sourceCode r" id="cb10"><code class="sourceCode r"><div class="sourceLine" id="cb10-1" data-line-number="1">
<span class="kw">tail</span>(cells &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tidy_table.html">tidy_table</a></span>(original))</div></code></pre>
<pre><code>## # A tibble: 6 x 3
##     row   col chr  
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;
## 1    17     6 75000
## 2    18     6 66000
## 3    19     6 &lt;NA&gt; 
## 4    20     6 60000
## 5    21     6 68000
## 6    22     6 18000</code></pre>
<div id="headers" class="section level3">
<h3 class="hasAnchor">
<a href="#headers" class="anchor"></a>Headers</h3>
<pre class="sourceCode r" id="cb12"><code class="sourceCode r"><div class="sourceLine" id="cb12-1" data-line-number="1">row_headers &lt;-</div>
<div class="sourceLine" id="cb12-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb12-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Select all rows of headers at once</span>
</div>
<div class="sourceLine" id="cb12-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb12-5" data-line-number="5">
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col) <span class="co"># Return each row of headers in its own element of a list</span>
</div>
<div class="sourceLine" id="cb12-6" data-line-number="6">row_headers</div></code></pre>
<pre><code>## $`1`
## # A tibble: 5 x 3
##     row   col header                    
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;                     
## 1     3     1 Bachelor's degree         
## 2     7     1 Certificate               
## 3    11     1 Diploma                   
## 4    15     1 No Qualification          
## 5    19     1 Postgraduate qualification
## 
## $`2`
## # A tibble: 20 x 3
##      row   col header 
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
##  1     3     2 15 - 24
##  2     4     2 25 - 44
##  3     5     2 45 - 64
##  4     6     2 65+    
##  5     7     2 15 - 24
##  6     8     2 25 - 44
##  7     9     2 45 - 64
##  8    10     2 65+    
##  9    11     2 15 - 24
## 10    12     2 25 - 44
## 11    13     2 45 - 64
## 12    14     2 65+    
## 13    15     2 15 - 24
## 14    16     2 25 - 44
## 15    17     2 45 - 64
## 16    18     2 65+    
## 17    19     2 15 - 24
## 18    20     2 25 - 44
## 19    21     2 45 - 64
## 20    22     2 65+</code></pre>
<pre class="sourceCode r" id="cb14"><code class="sourceCode r"><div class="sourceLine" id="cb14-1" data-line-number="1">col_headers &lt;-</div>
<div class="sourceLine" id="cb14-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb14-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb14-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb14-5" data-line-number="5">
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)</div>
<div class="sourceLine" id="cb14-6" data-line-number="6">col_headers</div></code></pre>
<pre><code>## $`1`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     1     3 Female
## 2     1     5 Male  
## 
## $`2`
## # A tibble: 4 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     2     3 0 - 6 
## 2     2     4 7 - 10
## 3     2     5 0 - 6 
## 4     2     6 7 - 10</code></pre>
</div>
<div id="data" class="section level3">
<h3 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h3>
<pre class="sourceCode r" id="cb16"><code class="sourceCode r"><div class="sourceLine" id="cb16-1" data-line-number="1">datacells &lt;-</div>
<div class="sourceLine" id="cb16-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb16-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb16-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb16-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, value)</div>
<div class="sourceLine" id="cb16-6" data-line-number="6">
<span class="kw">head</span>(datacells)</div></code></pre>
<pre><code>## # A tibble: 6 x 3
##     row   col value
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1     3     3  7000
## 2     4     3 12000
## 3     5     3 10000
## 4     7     3 29000
## 5     8     3 34000
## 6     9     3 30000</code></pre>
</div>
<div id="join-headers-to-data" class="section level3">
<h3 class="hasAnchor">
<a href="#join-headers-to-data" class="anchor"></a>Join headers to data</h3>
<pre class="sourceCode r" id="cb18"><code class="sourceCode r"><div class="sourceLine" id="cb18-1" data-line-number="1">datacells &lt;-</div>
<div class="sourceLine" id="cb18-2" data-line-number="2">
<span class="st">  </span>datacells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb18-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">NNW</a></span>(col_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb18-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">N</a></span>(col_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb18-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">WNW</a></span>(row_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb18-6" data-line-number="6">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">W</a></span>(row_headers[[<span class="dv">2</span>]])</div></code></pre>
</div>
<div id="result" class="section level3">
<h3 class="hasAnchor">
<a href="#result" class="anchor"></a>Result</h3>
<pre class="sourceCode r" id="cb19"><code class="sourceCode r"><div class="sourceLine" id="cb19-1" data-line-number="1">datacells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</div></code></pre>
<pre><code>##    row col  value header.data header.header           header.data.data
## 1    3   3   7000      Female         0 - 6          Bachelor's degree
## 2    4   3  12000      Female         0 - 6          Bachelor's degree
## 3    5   3  10000      Female         0 - 6          Bachelor's degree
## 4    7   3  29000      Female         0 - 6                Certificate
## 5    8   3  34000      Female         0 - 6                Certificate
## 6    9   3  30000      Female         0 - 6                Certificate
## 7   10   3  12000      Female         0 - 6                Certificate
## 8   12   3  10000      Female         0 - 6                    Diploma
## 9   13   3   6000      Female         0 - 6                    Diploma
## 10  14   3   5000      Female         0 - 6                    Diploma
## 11  15   3  10000      Female         0 - 6           No Qualification
## 12  16   3  11000      Female         0 - 6           No Qualification
## 13  17   3  19000      Female         0 - 6           No Qualification
## 14  18   3  16000      Female         0 - 6           No Qualification
## 15  20   3   5000      Female         0 - 6 Postgraduate qualification
## 16  21   3   6000      Female         0 - 6 Postgraduate qualification
## 17   3   4  27000      Female        7 - 10          Bachelor's degree
## 18   4   4 137000      Female        7 - 10          Bachelor's degree
## 19   5   4  64000      Female        7 - 10          Bachelor's degree
## 20   6   4  18000      Female        7 - 10          Bachelor's degree
## 21   7   4 161000      Female        7 - 10                Certificate
## 22   8   4 179000      Female        7 - 10                Certificate
## 23   9   4 210000      Female        7 - 10                Certificate
## 24  10   4  77000      Female        7 - 10                Certificate
## 25  11   4  14000      Female        7 - 10                    Diploma
## 26  12   4  66000      Female        7 - 10                    Diploma
## 27  13   4  68000      Female        7 - 10                    Diploma
## 28  14   4  41000      Female        7 - 10                    Diploma
## 29  15   4  43000      Female        7 - 10           No Qualification
## 30  16   4  36000      Female        7 - 10           No Qualification
## 31  17   4  91000      Female        7 - 10           No Qualification
## 32  18   4 118000      Female        7 - 10           No Qualification
## 33  19   4   6000      Female        7 - 10 Postgraduate qualification
## 34  20   4  86000      Female        7 - 10 Postgraduate qualification
## 35  21   4  55000      Female        7 - 10 Postgraduate qualification
## 36  22   4  13000      Female        7 - 10 Postgraduate qualification
## 37   4   5   9000        Male         0 - 6          Bachelor's degree
## 38   5   5   7000        Male         0 - 6          Bachelor's degree
## 39   6   5   7000        Male         0 - 6          Bachelor's degree
## 40   7   5  30000        Male         0 - 6                Certificate
## 41   8   5  31000        Male         0 - 6                Certificate
## 42   9   5  23000        Male         0 - 6                Certificate
## 43  10   5   8000        Male         0 - 6                Certificate
## 44  11   5   9000        Male         0 - 6                    Diploma
## 45  12   5   8000        Male         0 - 6                    Diploma
## 46  13   5   5000        Male         0 - 6                    Diploma
## 47  14   5   1000        Male         0 - 6                    Diploma
## 48  15   5  12000        Male         0 - 6           No Qualification
## 49  16   5  21000        Male         0 - 6           No Qualification
## 50  17   5  17000        Male         0 - 6           No Qualification
## 51  18   5   9000        Male         0 - 6           No Qualification
## 52  20   5   7000        Male         0 - 6 Postgraduate qualification
## 53  21   5   6000        Male         0 - 6 Postgraduate qualification
## 54   3   6  13000        Male        7 - 10          Bachelor's degree
## 55   4   6  81000        Male        7 - 10          Bachelor's degree
## 56   5   6  66000        Male        7 - 10          Bachelor's degree
## 57   6   6  17000        Male        7 - 10          Bachelor's degree
## 58   7   6 190000        Male        7 - 10                Certificate
## 59   8   6 219000        Male        7 - 10                Certificate
## 60   9   6 199000        Male        7 - 10                Certificate
## 61  10   6 107000        Male        7 - 10                Certificate
## 62  11   6  11000        Male        7 - 10                    Diploma
## 63  12   6  47000        Male        7 - 10                    Diploma
## 64  13   6  58000        Male        7 - 10                    Diploma
## 65  14   6  34000        Male        7 - 10                    Diploma
## 66  15   6  37000        Male        7 - 10           No Qualification
## 67  16   6  50000        Male        7 - 10           No Qualification
## 68  17   6  75000        Male        7 - 10           No Qualification
## 69  18   6  66000        Male        7 - 10           No Qualification
## 70  20   6  60000        Male        7 - 10 Postgraduate qualification
## 71  21   6  68000        Male        7 - 10 Postgraduate qualification
## 72  22   6  18000        Male        7 - 10 Postgraduate qualification
##    header.header.header
## 1               15 - 24
## 2               25 - 44
## 3               45 - 64
## 4               15 - 24
## 5               25 - 44
## 6               45 - 64
## 7                   65+
## 8               25 - 44
## 9               45 - 64
## 10                  65+
## 11              15 - 24
## 12              25 - 44
## 13              45 - 64
## 14                  65+
## 15              25 - 44
## 16              45 - 64
## 17              15 - 24
## 18              25 - 44
## 19              45 - 64
## 20                  65+
## 21              15 - 24
## 22              25 - 44
## 23              45 - 64
## 24                  65+
## 25              15 - 24
## 26              25 - 44
## 27              45 - 64
## 28                  65+
## 29              15 - 24
## 30              25 - 44
## 31              45 - 64
## 32                  65+
## 33              15 - 24
## 34              25 - 44
## 35              45 - 64
## 36                  65+
## 37              25 - 44
## 38              45 - 64
## 39                  65+
## 40              15 - 24
## 41              25 - 44
## 42              45 - 64
## 43                  65+
## 44              15 - 24
## 45              25 - 44
## 46              45 - 64
## 47                  65+
## 48              15 - 24
## 49              25 - 44
## 50              45 - 64
## 51                  65+
## 52              25 - 44
## 53              45 - 64
## 54              15 - 24
## 55              25 - 44
## 56              45 - 64
## 57                  65+
## 58              15 - 24
## 59              25 - 44
## 60              45 - 64
## 61                  65+
## 62              15 - 24
## 63              25 - 44
## 64              45 - 64
## 65                  65+
## 66              15 - 24
## 67              25 - 44
## 68              45 - 64
## 69                  65+
## 70              25 - 44
## 71              45 - 64
## 72                  65+</code></pre>
<pre class="sourceCode r" id="cb21"><code class="sourceCode r"><div class="sourceLine" id="cb21-1" data-line-number="1">NNW_WNW &lt;-<span class="st"> </span>datacells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(row, col)</div></code></pre>
</div>
</div>
<div id="nne-wsw-example" class="section level2">
<h2 class="hasAnchor">
<a href="#nne-wsw-example" class="anchor"></a>NNE WSW example</h2>
<pre class="sourceCode r" id="cb22"><code class="sourceCode r"><div class="sourceLine" id="cb22-1" data-line-number="1">cells &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tidy_table.html">tidy_table</a></span>(purpose<span class="op">$</span><span class="st">`</span><span class="dt">NNE WSW</span><span class="st">`</span>)</div></code></pre>
<div id="headers-same-as-nnw-wnw" class="section level3">
<h3 class="hasAnchor">
<a href="#headers-same-as-nnw-wnw" class="anchor"></a>Headers (same as NNW WNW)</h3>
<pre class="sourceCode r" id="cb23"><code class="sourceCode r"><div class="sourceLine" id="cb23-1" data-line-number="1">row_headers &lt;-</div>
<div class="sourceLine" id="cb23-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb23-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb23-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb23-5" data-line-number="5">
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)</div>
<div class="sourceLine" id="cb23-6" data-line-number="6">row_headers</div></code></pre>
<pre><code>## $`1`
## # A tibble: 5 x 3
##     row   col header                    
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;                     
## 1     6     1 Bachelor's degree         
## 2    10     1 Certificate               
## 3    14     1 Diploma                   
## 4    18     1 No Qualification          
## 5    22     1 Postgraduate qualification
## 
## $`2`
## # A tibble: 20 x 3
##      row   col header 
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
##  1     3     2 15 - 24
##  2     4     2 25 - 44
##  3     5     2 45 - 64
##  4     6     2 65+    
##  5     7     2 15 - 24
##  6     8     2 25 - 44
##  7     9     2 45 - 64
##  8    10     2 65+    
##  9    11     2 15 - 24
## 10    12     2 25 - 44
## 11    13     2 45 - 64
## 12    14     2 65+    
## 13    15     2 15 - 24
## 14    16     2 25 - 44
## 15    17     2 45 - 64
## 16    18     2 65+    
## 17    19     2 15 - 24
## 18    20     2 25 - 44
## 19    21     2 45 - 64
## 20    22     2 65+</code></pre>
<pre class="sourceCode r" id="cb25"><code class="sourceCode r"><div class="sourceLine" id="cb25-1" data-line-number="1">col_headers &lt;-</div>
<div class="sourceLine" id="cb25-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb25-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb25-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb25-5" data-line-number="5">
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)</div>
<div class="sourceLine" id="cb25-6" data-line-number="6">col_headers</div></code></pre>
<pre><code>## $`1`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     1     4 Female
## 2     1     6 Male  
## 
## $`2`
## # A tibble: 4 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     2     3 0 - 6 
## 2     2     4 7 - 10
## 3     2     5 0 - 6 
## 4     2     6 7 - 10</code></pre>
</div>
<div id="data-same-as-nnw-wnw" class="section level3">
<h3 class="hasAnchor">
<a href="#data-same-as-nnw-wnw" class="anchor"></a>Data (same as NNW WNW)</h3>
<pre class="sourceCode r" id="cb27"><code class="sourceCode r"><div class="sourceLine" id="cb27-1" data-line-number="1">datacells &lt;-</div>
<div class="sourceLine" id="cb27-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb27-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb27-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb27-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, value)</div>
<div class="sourceLine" id="cb27-6" data-line-number="6">datacells</div></code></pre>
<pre><code>## # A tibble: 72 x 3
##      row   col value
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1     3     3  7000
##  2     4     3 12000
##  3     5     3 10000
##  4     7     3 29000
##  5     8     3 34000
##  6     9     3 30000
##  7    10     3 12000
##  8    12     3 10000
##  9    13     3  6000
## 10    14     3  5000
## # ... with 62 more rows</code></pre>
</div>
<div id="join-headers-to-data-different-from-nnw-wnw" class="section level3">
<h3 class="hasAnchor">
<a href="#join-headers-to-data-different-from-nnw-wnw" class="anchor"></a>Join headers to data (different from NNW WNW)</h3>
<pre class="sourceCode r" id="cb29"><code class="sourceCode r"><div class="sourceLine" id="cb29-1" data-line-number="1">datacells &lt;-</div>
<div class="sourceLine" id="cb29-2" data-line-number="2">
<span class="st">  </span>datacells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb29-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">NNE</a></span>(col_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from NNW WNW</span>
</div>
<div class="sourceLine" id="cb29-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">N</a></span>(col_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Same as NNW WNW</span>
</div>
<div class="sourceLine" id="cb29-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">WSW</a></span>(row_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from NNW WNW</span>
</div>
<div class="sourceLine" id="cb29-6" data-line-number="6">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">W</a></span>(row_headers[[<span class="dv">2</span>]]) <span class="co"># Same as NNW WNW</span>
</div></code></pre>
</div>
<div id="result-1" class="section level3">
<h3 class="hasAnchor">
<a href="#result-1" class="anchor"></a>Result</h3>
<pre class="sourceCode r" id="cb30"><code class="sourceCode r"><div class="sourceLine" id="cb30-1" data-line-number="1">datacells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</div></code></pre>
<pre><code>##    row col  value header.data header.header           header.data.data
## 1    3   3   7000      Female         0 - 6          Bachelor's degree
## 2    4   3  12000      Female         0 - 6          Bachelor's degree
## 3    5   3  10000      Female         0 - 6          Bachelor's degree
## 4    7   3  29000      Female         0 - 6                Certificate
## 5    8   3  34000      Female         0 - 6                Certificate
## 6    9   3  30000      Female         0 - 6                Certificate
## 7   10   3  12000      Female         0 - 6                Certificate
## 8   12   3  10000      Female         0 - 6                    Diploma
## 9   13   3   6000      Female         0 - 6                    Diploma
## 10  14   3   5000      Female         0 - 6                    Diploma
## 11  15   3  10000      Female         0 - 6           No Qualification
## 12  16   3  11000      Female         0 - 6           No Qualification
## 13  17   3  19000      Female         0 - 6           No Qualification
## 14  18   3  16000      Female         0 - 6           No Qualification
## 15  20   3   5000      Female         0 - 6 Postgraduate qualification
## 16  21   3   6000      Female         0 - 6 Postgraduate qualification
## 17   3   4  27000      Female        7 - 10          Bachelor's degree
## 18   4   4 137000      Female        7 - 10          Bachelor's degree
## 19   5   4  64000      Female        7 - 10          Bachelor's degree
## 20   6   4  18000      Female        7 - 10          Bachelor's degree
## 21   7   4 161000      Female        7 - 10                Certificate
## 22   8   4 179000      Female        7 - 10                Certificate
## 23   9   4 210000      Female        7 - 10                Certificate
## 24  10   4  77000      Female        7 - 10                Certificate
## 25  11   4  14000      Female        7 - 10                    Diploma
## 26  12   4  66000      Female        7 - 10                    Diploma
## 27  13   4  68000      Female        7 - 10                    Diploma
## 28  14   4  41000      Female        7 - 10                    Diploma
## 29  15   4  43000      Female        7 - 10           No Qualification
## 30  16   4  36000      Female        7 - 10           No Qualification
## 31  17   4  91000      Female        7 - 10           No Qualification
## 32  18   4 118000      Female        7 - 10           No Qualification
## 33  19   4   6000      Female        7 - 10 Postgraduate qualification
## 34  20   4  86000      Female        7 - 10 Postgraduate qualification
## 35  21   4  55000      Female        7 - 10 Postgraduate qualification
## 36  22   4  13000      Female        7 - 10 Postgraduate qualification
## 37   4   5   9000        Male         0 - 6          Bachelor's degree
## 38   5   5   7000        Male         0 - 6          Bachelor's degree
## 39   6   5   7000        Male         0 - 6          Bachelor's degree
## 40   7   5  30000        Male         0 - 6                Certificate
## 41   8   5  31000        Male         0 - 6                Certificate
## 42   9   5  23000        Male         0 - 6                Certificate
## 43  10   5   8000        Male         0 - 6                Certificate
## 44  11   5   9000        Male         0 - 6                    Diploma
## 45  12   5   8000        Male         0 - 6                    Diploma
## 46  13   5   5000        Male         0 - 6                    Diploma
## 47  14   5   1000        Male         0 - 6                    Diploma
## 48  15   5  12000        Male         0 - 6           No Qualification
## 49  16   5  21000        Male         0 - 6           No Qualification
## 50  17   5  17000        Male         0 - 6           No Qualification
## 51  18   5   9000        Male         0 - 6           No Qualification
## 52  20   5   7000        Male         0 - 6 Postgraduate qualification
## 53  21   5   6000        Male         0 - 6 Postgraduate qualification
## 54   3   6  13000        Male        7 - 10          Bachelor's degree
## 55   4   6  81000        Male        7 - 10          Bachelor's degree
## 56   5   6  66000        Male        7 - 10          Bachelor's degree
## 57   6   6  17000        Male        7 - 10          Bachelor's degree
## 58   7   6 190000        Male        7 - 10                Certificate
## 59   8   6 219000        Male        7 - 10                Certificate
## 60   9   6 199000        Male        7 - 10                Certificate
## 61  10   6 107000        Male        7 - 10                Certificate
## 62  11   6  11000        Male        7 - 10                    Diploma
## 63  12   6  47000        Male        7 - 10                    Diploma
## 64  13   6  58000        Male        7 - 10                    Diploma
## 65  14   6  34000        Male        7 - 10                    Diploma
## 66  15   6  37000        Male        7 - 10           No Qualification
## 67  16   6  50000        Male        7 - 10           No Qualification
## 68  17   6  75000        Male        7 - 10           No Qualification
## 69  18   6  66000        Male        7 - 10           No Qualification
## 70  20   6  60000        Male        7 - 10 Postgraduate qualification
## 71  21   6  68000        Male        7 - 10 Postgraduate qualification
## 72  22   6  18000        Male        7 - 10 Postgraduate qualification
##    header.header.header
## 1               15 - 24
## 2               25 - 44
## 3               45 - 64
## 4               15 - 24
## 5               25 - 44
## 6               45 - 64
## 7                   65+
## 8               25 - 44
## 9               45 - 64
## 10                  65+
## 11              15 - 24
## 12              25 - 44
## 13              45 - 64
## 14                  65+
## 15              25 - 44
## 16              45 - 64
## 17              15 - 24
## 18              25 - 44
## 19              45 - 64
## 20                  65+
## 21              15 - 24
## 22              25 - 44
## 23              45 - 64
## 24                  65+
## 25              15 - 24
## 26              25 - 44
## 27              45 - 64
## 28                  65+
## 29              15 - 24
## 30              25 - 44
## 31              45 - 64
## 32                  65+
## 33              15 - 24
## 34              25 - 44
## 35              45 - 64
## 36                  65+
## 37              25 - 44
## 38              45 - 64
## 39                  65+
## 40              15 - 24
## 41              25 - 44
## 42              45 - 64
## 43                  65+
## 44              15 - 24
## 45              25 - 44
## 46              45 - 64
## 47                  65+
## 48              15 - 24
## 49              25 - 44
## 50              45 - 64
## 51                  65+
## 52              25 - 44
## 53              45 - 64
## 54              15 - 24
## 55              25 - 44
## 56              45 - 64
## 57                  65+
## 58              15 - 24
## 59              25 - 44
## 60              45 - 64
## 61                  65+
## 62              15 - 24
## 63              25 - 44
## 64              45 - 64
## 65                  65+
## 66              15 - 24
## 67              25 - 44
## 68              45 - 64
## 69                  65+
## 70              25 - 44
## 71              45 - 64
## 72                  65+</code></pre>
<pre class="sourceCode r" id="cb32"><code class="sourceCode r"><div class="sourceLine" id="cb32-1" data-line-number="1">NNE_WSW &lt;-<span class="st"> </span>datacells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(row, col)</div></code></pre>
</div>
</div>
<div id="sse-ese-example" class="section level2">
<h2 class="hasAnchor">
<a href="#sse-ese-example" class="anchor"></a>SSE ESE example</h2>
<pre class="sourceCode r" id="cb33"><code class="sourceCode r"><div class="sourceLine" id="cb33-1" data-line-number="1">cells &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tidy_table.html">tidy_table</a></span>(purpose<span class="op">$</span><span class="st">`</span><span class="dt">SSE ESE</span><span class="st">`</span>)</div></code></pre>
<div id="headers-1" class="section level3">
<h3 class="hasAnchor">
<a href="#headers-1" class="anchor"></a>Headers</h3>
<pre class="sourceCode r" id="cb34"><code class="sourceCode r"><div class="sourceLine" id="cb34-1" data-line-number="1">row_headers &lt;-</div>
<div class="sourceLine" id="cb34-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb34-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb34-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb34-5" data-line-number="5">
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)</div>
<div class="sourceLine" id="cb34-6" data-line-number="6">row_headers</div></code></pre>
<pre><code>## $`5`
## # A tibble: 20 x 3
##      row   col header 
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
##  1     1     5 15 - 24
##  2     2     5 25 - 44
##  3     3     5 45 - 64
##  4     4     5 65+    
##  5     5     5 15 - 24
##  6     6     5 25 - 44
##  7     7     5 45 - 64
##  8     8     5 65+    
##  9     9     5 15 - 24
## 10    10     5 25 - 44
## 11    11     5 45 - 64
## 12    12     5 65+    
## 13    13     5 15 - 24
## 14    14     5 25 - 44
## 15    15     5 45 - 64
## 16    16     5 65+    
## 17    17     5 15 - 24
## 18    18     5 25 - 44
## 19    19     5 45 - 64
## 20    20     5 65+    
## 
## $`6`
## # A tibble: 5 x 3
##     row   col header                    
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;                     
## 1     4     6 Bachelor's degree         
## 2     8     6 Certificate               
## 3    12     6 Diploma                   
## 4    16     6 No Qualification          
## 5    20     6 Postgraduate qualification</code></pre>
<pre class="sourceCode r" id="cb36"><code class="sourceCode r"><div class="sourceLine" id="cb36-1" data-line-number="1">col_headers &lt;-</div>
<div class="sourceLine" id="cb36-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb36-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">21</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb36-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb36-5" data-line-number="5">
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)</div>
<div class="sourceLine" id="cb36-6" data-line-number="6">col_headers</div></code></pre>
<pre><code>## $`21`
## # A tibble: 4 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1    21     1 0 - 6 
## 2    21     2 7 - 10
## 3    21     3 0 - 6 
## 4    21     4 7 - 10
## 
## $`22`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1    22     2 Female
## 2    22     4 Male</code></pre>
</div>
<div id="data-1" class="section level3">
<h3 class="hasAnchor">
<a href="#data-1" class="anchor"></a>Data</h3>
<pre class="sourceCode r" id="cb38"><code class="sourceCode r"><div class="sourceLine" id="cb38-1" data-line-number="1">datacells &lt;-</div>
<div class="sourceLine" id="cb38-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb38-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">20</span>, col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">4</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb38-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb38-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, value)</div>
<div class="sourceLine" id="cb38-6" data-line-number="6">datacells</div></code></pre>
<pre><code>## # A tibble: 72 x 3
##      row   col value
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1     1     1  7000
##  2     2     1 12000
##  3     3     1 10000
##  4     5     1 29000
##  5     6     1 34000
##  6     7     1 30000
##  7     8     1 12000
##  8    10     1 10000
##  9    11     1  6000
## 10    12     1  5000
## # ... with 62 more rows</code></pre>
</div>
<div id="join-headers-to-data-1" class="section level3">
<h3 class="hasAnchor">
<a href="#join-headers-to-data-1" class="anchor"></a>Join headers to data</h3>
<pre class="sourceCode r" id="cb40"><code class="sourceCode r"><div class="sourceLine" id="cb40-1" data-line-number="1">datacells &lt;-</div>
<div class="sourceLine" id="cb40-2" data-line-number="2">
<span class="st">  </span>datacells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb40-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">SSE</a></span>(col_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb40-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">S</a></span>(col_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb40-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">ESE</a></span>(row_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb40-6" data-line-number="6">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">E</a></span>(row_headers[[<span class="dv">1</span>]])</div></code></pre>
</div>
<div id="result-2" class="section level3">
<h3 class="hasAnchor">
<a href="#result-2" class="anchor"></a>Result</h3>
<pre class="sourceCode r" id="cb41"><code class="sourceCode r"><div class="sourceLine" id="cb41-1" data-line-number="1">datacells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</div></code></pre>
<pre><code>##    row col  value header.data header.header           header.data.data
## 1    1   1   7000      Female         0 - 6          Bachelor's degree
## 2    2   1  12000      Female         0 - 6          Bachelor's degree
## 3    3   1  10000      Female         0 - 6          Bachelor's degree
## 4    5   1  29000      Female         0 - 6                Certificate
## 5    6   1  34000      Female         0 - 6                Certificate
## 6    7   1  30000      Female         0 - 6                Certificate
## 7    8   1  12000      Female         0 - 6                Certificate
## 8   10   1  10000      Female         0 - 6                    Diploma
## 9   11   1   6000      Female         0 - 6                    Diploma
## 10  12   1   5000      Female         0 - 6                    Diploma
## 11  13   1  10000      Female         0 - 6           No Qualification
## 12  14   1  11000      Female         0 - 6           No Qualification
## 13  15   1  19000      Female         0 - 6           No Qualification
## 14  16   1  16000      Female         0 - 6           No Qualification
## 15  18   1   5000      Female         0 - 6 Postgraduate qualification
## 16  19   1   6000      Female         0 - 6 Postgraduate qualification
## 17   1   2  27000      Female        7 - 10          Bachelor's degree
## 18   2   2 137000      Female        7 - 10          Bachelor's degree
## 19   3   2  64000      Female        7 - 10          Bachelor's degree
## 20   4   2  18000      Female        7 - 10          Bachelor's degree
## 21   5   2 161000      Female        7 - 10                Certificate
## 22   6   2 179000      Female        7 - 10                Certificate
## 23   7   2 210000      Female        7 - 10                Certificate
## 24   8   2  77000      Female        7 - 10                Certificate
## 25   9   2  14000      Female        7 - 10                    Diploma
## 26  10   2  66000      Female        7 - 10                    Diploma
## 27  11   2  68000      Female        7 - 10                    Diploma
## 28  12   2  41000      Female        7 - 10                    Diploma
## 29  13   2  43000      Female        7 - 10           No Qualification
## 30  14   2  36000      Female        7 - 10           No Qualification
## 31  15   2  91000      Female        7 - 10           No Qualification
## 32  16   2 118000      Female        7 - 10           No Qualification
## 33  17   2   6000      Female        7 - 10 Postgraduate qualification
## 34  18   2  86000      Female        7 - 10 Postgraduate qualification
## 35  19   2  55000      Female        7 - 10 Postgraduate qualification
## 36  20   2  13000      Female        7 - 10 Postgraduate qualification
## 37   2   3   9000        Male         0 - 6          Bachelor's degree
## 38   3   3   7000        Male         0 - 6          Bachelor's degree
## 39   4   3   7000        Male         0 - 6          Bachelor's degree
## 40   5   3  30000        Male         0 - 6                Certificate
## 41   6   3  31000        Male         0 - 6                Certificate
## 42   7   3  23000        Male         0 - 6                Certificate
## 43   8   3   8000        Male         0 - 6                Certificate
## 44   9   3   9000        Male         0 - 6                    Diploma
## 45  10   3   8000        Male         0 - 6                    Diploma
## 46  11   3   5000        Male         0 - 6                    Diploma
## 47  12   3   1000        Male         0 - 6                    Diploma
## 48  13   3  12000        Male         0 - 6           No Qualification
## 49  14   3  21000        Male         0 - 6           No Qualification
## 50  15   3  17000        Male         0 - 6           No Qualification
## 51  16   3   9000        Male         0 - 6           No Qualification
## 52  18   3   7000        Male         0 - 6 Postgraduate qualification
## 53  19   3   6000        Male         0 - 6 Postgraduate qualification
## 54   1   4  13000        Male        7 - 10          Bachelor's degree
## 55   2   4  81000        Male        7 - 10          Bachelor's degree
## 56   3   4  66000        Male        7 - 10          Bachelor's degree
## 57   4   4  17000        Male        7 - 10          Bachelor's degree
## 58   5   4 190000        Male        7 - 10                Certificate
## 59   6   4 219000        Male        7 - 10                Certificate
## 60   7   4 199000        Male        7 - 10                Certificate
## 61   8   4 107000        Male        7 - 10                Certificate
## 62   9   4  11000        Male        7 - 10                    Diploma
## 63  10   4  47000        Male        7 - 10                    Diploma
## 64  11   4  58000        Male        7 - 10                    Diploma
## 65  12   4  34000        Male        7 - 10                    Diploma
## 66  13   4  37000        Male        7 - 10           No Qualification
## 67  14   4  50000        Male        7 - 10           No Qualification
## 68  15   4  75000        Male        7 - 10           No Qualification
## 69  16   4  66000        Male        7 - 10           No Qualification
## 70  18   4  60000        Male        7 - 10 Postgraduate qualification
## 71  19   4  68000        Male        7 - 10 Postgraduate qualification
## 72  20   4  18000        Male        7 - 10 Postgraduate qualification
##    header.header.header
## 1               15 - 24
## 2               25 - 44
## 3               45 - 64
## 4               15 - 24
## 5               25 - 44
## 6               45 - 64
## 7                   65+
## 8               25 - 44
## 9               45 - 64
## 10                  65+
## 11              15 - 24
## 12              25 - 44
## 13              45 - 64
## 14                  65+
## 15              25 - 44
## 16              45 - 64
## 17              15 - 24
## 18              25 - 44
## 19              45 - 64
## 20                  65+
## 21              15 - 24
## 22              25 - 44
## 23              45 - 64
## 24                  65+
## 25              15 - 24
## 26              25 - 44
## 27              45 - 64
## 28                  65+
## 29              15 - 24
## 30              25 - 44
## 31              45 - 64
## 32                  65+
## 33              15 - 24
## 34              25 - 44
## 35              45 - 64
## 36                  65+
## 37              25 - 44
## 38              45 - 64
## 39                  65+
## 40              15 - 24
## 41              25 - 44
## 42              45 - 64
## 43                  65+
## 44              15 - 24
## 45              25 - 44
## 46              45 - 64
## 47                  65+
## 48              15 - 24
## 49              25 - 44
## 50              45 - 64
## 51                  65+
## 52              25 - 44
## 53              45 - 64
## 54              15 - 24
## 55              25 - 44
## 56              45 - 64
## 57                  65+
## 58              15 - 24
## 59              25 - 44
## 60              45 - 64
## 61                  65+
## 62              15 - 24
## 63              25 - 44
## 64              45 - 64
## 65                  65+
## 66              15 - 24
## 67              25 - 44
## 68              45 - 64
## 69                  65+
## 70              25 - 44
## 71              45 - 64
## 72                  65+</code></pre>
<pre class="sourceCode r" id="cb43"><code class="sourceCode r"><div class="sourceLine" id="cb43-1" data-line-number="1">SSE_ESE &lt;-<span class="st"> </span>datacells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(row, col)</div></code></pre>
</div>
</div>
<div id="ssw-ene-example" class="section level2">
<h2 class="hasAnchor">
<a href="#ssw-ene-example" class="anchor"></a>SSW ENE example</h2>
<pre class="sourceCode r" id="cb44"><code class="sourceCode r"><div class="sourceLine" id="cb44-1" data-line-number="1">cells &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tidy_table.html">tidy_table</a></span>(purpose<span class="op">$</span><span class="st">`</span><span class="dt">SSW ENE</span><span class="st">`</span>)</div></code></pre>
<div id="headers-same-as-sse-ese" class="section level3">
<h3 class="hasAnchor">
<a href="#headers-same-as-sse-ese" class="anchor"></a>Headers (same as SSE ESE)</h3>
<pre class="sourceCode r" id="cb45"><code class="sourceCode r"><div class="sourceLine" id="cb45-1" data-line-number="1">row_headers &lt;-</div>
<div class="sourceLine" id="cb45-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb45-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb45-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb45-5" data-line-number="5">
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)</div>
<div class="sourceLine" id="cb45-6" data-line-number="6">row_headers</div></code></pre>
<pre><code>## $`5`
## # A tibble: 20 x 3
##      row   col header 
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
##  1     1     5 15 - 24
##  2     2     5 25 - 44
##  3     3     5 45 - 64
##  4     4     5 65+    
##  5     5     5 15 - 24
##  6     6     5 25 - 44
##  7     7     5 45 - 64
##  8     8     5 65+    
##  9     9     5 15 - 24
## 10    10     5 25 - 44
## 11    11     5 45 - 64
## 12    12     5 65+    
## 13    13     5 15 - 24
## 14    14     5 25 - 44
## 15    15     5 45 - 64
## 16    16     5 65+    
## 17    17     5 15 - 24
## 18    18     5 25 - 44
## 19    19     5 45 - 64
## 20    20     5 65+    
## 
## $`6`
## # A tibble: 5 x 3
##     row   col header                    
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;                     
## 1     1     6 Bachelor's degree         
## 2     5     6 Certificate               
## 3     9     6 Diploma                   
## 4    13     6 No Qualification          
## 5    17     6 Postgraduate qualification</code></pre>
<pre class="sourceCode r" id="cb47"><code class="sourceCode r"><div class="sourceLine" id="cb47-1" data-line-number="1">col_headers &lt;-</div>
<div class="sourceLine" id="cb47-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb47-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">21</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb47-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb47-5" data-line-number="5">
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)</div>
<div class="sourceLine" id="cb47-6" data-line-number="6">col_headers</div></code></pre>
<pre><code>## $`21`
## # A tibble: 4 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1    21     1 0 - 6 
## 2    21     2 7 - 10
## 3    21     3 0 - 6 
## 4    21     4 7 - 10
## 
## $`22`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1    22     1 Female
## 2    22     3 Male</code></pre>
</div>
<div id="data-same-as-sse-ese" class="section level3">
<h3 class="hasAnchor">
<a href="#data-same-as-sse-ese" class="anchor"></a>Data (same as SSE ESE)</h3>
<pre class="sourceCode r" id="cb49"><code class="sourceCode r"><div class="sourceLine" id="cb49-1" data-line-number="1">datacells &lt;-</div>
<div class="sourceLine" id="cb49-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb49-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">20</span>, col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">4</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb49-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb49-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, value)</div>
<div class="sourceLine" id="cb49-6" data-line-number="6">datacells</div></code></pre>
<pre><code>## # A tibble: 72 x 3
##      row   col value
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1     1     1  7000
##  2     2     1 12000
##  3     3     1 10000
##  4     5     1 29000
##  5     6     1 34000
##  6     7     1 30000
##  7     8     1 12000
##  8    10     1 10000
##  9    11     1  6000
## 10    12     1  5000
## # ... with 62 more rows</code></pre>
</div>
<div id="join-headers-to-data-2" class="section level3">
<h3 class="hasAnchor">
<a href="#join-headers-to-data-2" class="anchor"></a>Join headers to data</h3>
<pre class="sourceCode r" id="cb51"><code class="sourceCode r"><div class="sourceLine" id="cb51-1" data-line-number="1">datacells &lt;-</div>
<div class="sourceLine" id="cb51-2" data-line-number="2">
<span class="st">  </span>datacells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb51-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">SSW</a></span>(col_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from SSE ESE</span>
</div>
<div class="sourceLine" id="cb51-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">S</a></span>(col_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Same as SSE ESE</span>
</div>
<div class="sourceLine" id="cb51-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">ENE</a></span>(row_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from SSE ESE</span>
</div>
<div class="sourceLine" id="cb51-6" data-line-number="6">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">E</a></span>(row_headers[[<span class="dv">1</span>]]) <span class="co"># Same as SSE ESE</span>
</div></code></pre>
</div>
<div id="result-3" class="section level3">
<h3 class="hasAnchor">
<a href="#result-3" class="anchor"></a>Result</h3>
<pre class="sourceCode r" id="cb52"><code class="sourceCode r"><div class="sourceLine" id="cb52-1" data-line-number="1">datacells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</div></code></pre>
<pre><code>##    row col  value header.data header.header           header.data.data
## 1    1   1   7000      Female         0 - 6          Bachelor's degree
## 2    2   1  12000      Female         0 - 6          Bachelor's degree
## 3    3   1  10000      Female         0 - 6          Bachelor's degree
## 4    5   1  29000      Female         0 - 6                Certificate
## 5    6   1  34000      Female         0 - 6                Certificate
## 6    7   1  30000      Female         0 - 6                Certificate
## 7    8   1  12000      Female         0 - 6                Certificate
## 8   10   1  10000      Female         0 - 6                    Diploma
## 9   11   1   6000      Female         0 - 6                    Diploma
## 10  12   1   5000      Female         0 - 6                    Diploma
## 11  13   1  10000      Female         0 - 6           No Qualification
## 12  14   1  11000      Female         0 - 6           No Qualification
## 13  15   1  19000      Female         0 - 6           No Qualification
## 14  16   1  16000      Female         0 - 6           No Qualification
## 15  18   1   5000      Female         0 - 6 Postgraduate qualification
## 16  19   1   6000      Female         0 - 6 Postgraduate qualification
## 17   1   2  27000      Female        7 - 10          Bachelor's degree
## 18   2   2 137000      Female        7 - 10          Bachelor's degree
## 19   3   2  64000      Female        7 - 10          Bachelor's degree
## 20   4   2  18000      Female        7 - 10          Bachelor's degree
## 21   5   2 161000      Female        7 - 10                Certificate
## 22   6   2 179000      Female        7 - 10                Certificate
## 23   7   2 210000      Female        7 - 10                Certificate
## 24   8   2  77000      Female        7 - 10                Certificate
## 25   9   2  14000      Female        7 - 10                    Diploma
## 26  10   2  66000      Female        7 - 10                    Diploma
## 27  11   2  68000      Female        7 - 10                    Diploma
## 28  12   2  41000      Female        7 - 10                    Diploma
## 29  13   2  43000      Female        7 - 10           No Qualification
## 30  14   2  36000      Female        7 - 10           No Qualification
## 31  15   2  91000      Female        7 - 10           No Qualification
## 32  16   2 118000      Female        7 - 10           No Qualification
## 33  17   2   6000      Female        7 - 10 Postgraduate qualification
## 34  18   2  86000      Female        7 - 10 Postgraduate qualification
## 35  19   2  55000      Female        7 - 10 Postgraduate qualification
## 36  20   2  13000      Female        7 - 10 Postgraduate qualification
## 37   2   3   9000        Male         0 - 6          Bachelor's degree
## 38   3   3   7000        Male         0 - 6          Bachelor's degree
## 39   4   3   7000        Male         0 - 6          Bachelor's degree
## 40   5   3  30000        Male         0 - 6                Certificate
## 41   6   3  31000        Male         0 - 6                Certificate
## 42   7   3  23000        Male         0 - 6                Certificate
## 43   8   3   8000        Male         0 - 6                Certificate
## 44   9   3   9000        Male         0 - 6                    Diploma
## 45  10   3   8000        Male         0 - 6                    Diploma
## 46  11   3   5000        Male         0 - 6                    Diploma
## 47  12   3   1000        Male         0 - 6                    Diploma
## 48  13   3  12000        Male         0 - 6           No Qualification
## 49  14   3  21000        Male         0 - 6           No Qualification
## 50  15   3  17000        Male         0 - 6           No Qualification
## 51  16   3   9000        Male         0 - 6           No Qualification
## 52  18   3   7000        Male         0 - 6 Postgraduate qualification
## 53  19   3   6000        Male         0 - 6 Postgraduate qualification
## 54   1   4  13000        Male        7 - 10          Bachelor's degree
## 55   2   4  81000        Male        7 - 10          Bachelor's degree
## 56   3   4  66000        Male        7 - 10          Bachelor's degree
## 57   4   4  17000        Male        7 - 10          Bachelor's degree
## 58   5   4 190000        Male        7 - 10                Certificate
## 59   6   4 219000        Male        7 - 10                Certificate
## 60   7   4 199000        Male        7 - 10                Certificate
## 61   8   4 107000        Male        7 - 10                Certificate
## 62   9   4  11000        Male        7 - 10                    Diploma
## 63  10   4  47000        Male        7 - 10                    Diploma
## 64  11   4  58000        Male        7 - 10                    Diploma
## 65  12   4  34000        Male        7 - 10                    Diploma
## 66  13   4  37000        Male        7 - 10           No Qualification
## 67  14   4  50000        Male        7 - 10           No Qualification
## 68  15   4  75000        Male        7 - 10           No Qualification
## 69  16   4  66000        Male        7 - 10           No Qualification
## 70  18   4  60000        Male        7 - 10 Postgraduate qualification
## 71  19   4  68000        Male        7 - 10 Postgraduate qualification
## 72  20   4  18000        Male        7 - 10 Postgraduate qualification
##    header.header.header
## 1               15 - 24
## 2               25 - 44
## 3               45 - 64
## 4               15 - 24
## 5               25 - 44
## 6               45 - 64
## 7                   65+
## 8               25 - 44
## 9               45 - 64
## 10                  65+
## 11              15 - 24
## 12              25 - 44
## 13              45 - 64
## 14                  65+
## 15              25 - 44
## 16              45 - 64
## 17              15 - 24
## 18              25 - 44
## 19              45 - 64
## 20                  65+
## 21              15 - 24
## 22              25 - 44
## 23              45 - 64
## 24                  65+
## 25              15 - 24
## 26              25 - 44
## 27              45 - 64
## 28                  65+
## 29              15 - 24
## 30              25 - 44
## 31              45 - 64
## 32                  65+
## 33              15 - 24
## 34              25 - 44
## 35              45 - 64
## 36                  65+
## 37              25 - 44
## 38              45 - 64
## 39                  65+
## 40              15 - 24
## 41              25 - 44
## 42              45 - 64
## 43                  65+
## 44              15 - 24
## 45              25 - 44
## 46              45 - 64
## 47                  65+
## 48              15 - 24
## 49              25 - 44
## 50              45 - 64
## 51                  65+
## 52              25 - 44
## 53              45 - 64
## 54              15 - 24
## 55              25 - 44
## 56              45 - 64
## 57                  65+
## 58              15 - 24
## 59              25 - 44
## 60              45 - 64
## 61                  65+
## 62              15 - 24
## 63              25 - 44
## 64              45 - 64
## 65                  65+
## 66              15 - 24
## 67              25 - 44
## 68              45 - 64
## 69                  65+
## 70              25 - 44
## 71              45 - 64
## 72                  65+</code></pre>
<pre class="sourceCode r" id="cb54"><code class="sourceCode r"><div class="sourceLine" id="cb54-1" data-line-number="1">SSW_ENE &lt;-<span class="st"> </span>datacells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(row, col)</div></code></pre>
</div>
</div>
<div id="check-that-all-sheets-are-parsed-correctly" class="section level2">
<h2 class="hasAnchor">
<a href="#check-that-all-sheets-are-parsed-correctly" class="anchor"></a>Check that all sheets are parsed correctly</h2>
<pre class="sourceCode r" id="cb55"><code class="sourceCode r"><div class="sourceLine" id="cb55-1" data-line-number="1">
<span class="kw">identical</span>(NNW_WNW, NNE_WSW)</div></code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r" id="cb57"><code class="sourceCode r"><div class="sourceLine" id="cb57-1" data-line-number="1">
<span class="kw">identical</span>(SSW_ENE, SSE_ESE)</div></code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r" id="cb59"><code class="sourceCode r"><div class="sourceLine" id="cb59-1" data-line-number="1">
<span class="kw">identical</span>(NNW_WNW[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>], SSW_ENE[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>])</div></code></pre>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="above-left-example" class="section level2">
<h2 class="hasAnchor">
<a href="#above-left-example" class="anchor"></a>ABOVE LEFT example</h2>
<pre class="sourceCode r" id="cb61"><code class="sourceCode r"><div class="sourceLine" id="cb61-1" data-line-number="1">cells &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tidy_table.html">tidy_table</a></span>(purpose<span class="op">$</span><span class="st">`</span><span class="dt">ABOVE LEFT</span><span class="st">`</span>)</div></code></pre>
<div id="headers-2" class="section level3">
<h3 class="hasAnchor">
<a href="#headers-2" class="anchor"></a>Headers</h3>
<pre class="sourceCode r" id="cb62"><code class="sourceCode r"><div class="sourceLine" id="cb62-1" data-line-number="1">row_headers &lt;-</div>
<div class="sourceLine" id="cb62-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb62-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb62-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb62-5" data-line-number="5">
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)</div>
<div class="sourceLine" id="cb62-6" data-line-number="6">row_headers</div></code></pre>
<pre><code>## $`1`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     5     1 Female
## 2    10     1 Male  
## 
## $`2`
## # A tibble: 10 x 3
##      row   col header                    
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;                     
##  1     3     2 Bachelor's degree         
##  2     4     2 Certificate               
##  3     5     2 Diploma                   
##  4     6     2 No Qualification          
##  5     7     2 Postgraduate qualification
##  6     8     2 Bachelor's degree         
##  7     9     2 Certificate               
##  8    10     2 Diploma                   
##  9    11     2 No Qualification          
## 10    12     2 Postgraduate qualification</code></pre>
<pre class="sourceCode r" id="cb64"><code class="sourceCode r"><div class="sourceLine" id="cb64-1" data-line-number="1">col_headers &lt;-</div>
<div class="sourceLine" id="cb64-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb64-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb64-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb64-5" data-line-number="5">
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)</div>
<div class="sourceLine" id="cb64-6" data-line-number="6">col_headers</div></code></pre>
<pre><code>## $`1`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     1     4 0 - 6 
## 2     1     7 7 - 10
## 
## $`2`
## # A tibble: 6 x 3
##     row   col header 
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
## 1     2     3 15 - 24
## 2     2     4 25 - 44
## 3     2     5 45 - 64
## 4     2     6 15 - 24
## 5     2     7 25 - 44
## 6     2     8 45 - 64</code></pre>
</div>
<div id="data-2" class="section level3">
<h3 class="hasAnchor">
<a href="#data-2" class="anchor"></a>Data</h3>
<pre class="sourceCode r" id="cb66"><code class="sourceCode r"><div class="sourceLine" id="cb66-1" data-line-number="1">datacells &lt;-</div>
<div class="sourceLine" id="cb66-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb66-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb66-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb66-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, value)</div>
<div class="sourceLine" id="cb66-6" data-line-number="6">datacells</div></code></pre>
<pre><code>## # A tibble: 55 x 3
##      row   col value
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1     3     3  7000
##  2     4     3 29000
##  3     6     3 10000
##  4     9     3 30000
##  5    10     3  9000
##  6    11     3 12000
##  7     3     4 12000
##  8     4     4 34000
##  9     5     4 10000
## 10     6     4 11000
## # ... with 45 more rows</code></pre>
</div>
<div id="join-headers-to-data-3" class="section level3">
<h3 class="hasAnchor">
<a href="#join-headers-to-data-3" class="anchor"></a>Join headers to data</h3>
<pre class="sourceCode r" id="cb68"><code class="sourceCode r"><div class="sourceLine" id="cb68-1" data-line-number="1">datacells &lt;-</div>
<div class="sourceLine" id="cb68-2" data-line-number="2">
<span class="st">  </span>datacells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb68-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">ABOVE</a></span>(col_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from SSE ESE</span>
</div>
<div class="sourceLine" id="cb68-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">N</a></span>(col_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Same as SSE ESE</span>
</div>
<div class="sourceLine" id="cb68-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">LEFT</a></span>(row_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from SSE ESE</span>
</div>
<div class="sourceLine" id="cb68-6" data-line-number="6">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">W</a></span>(row_headers[[<span class="dv">2</span>]]) <span class="co"># Same as SSE ESE</span>
</div></code></pre>
</div>
<div id="result-4" class="section level3">
<h3 class="hasAnchor">
<a href="#result-4" class="anchor"></a>Result</h3>
<pre class="sourceCode r" id="cb69"><code class="sourceCode r"><div class="sourceLine" id="cb69-1" data-line-number="1">datacells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</div></code></pre>
<pre><code>##    row col  value header.data header.header header.data.data
## 1    3   3   7000       0 - 6       15 - 24           Female
## 2    4   3  29000       0 - 6       15 - 24           Female
## 3    6   3  10000       0 - 6       15 - 24           Female
## 4    9   3  30000       0 - 6       15 - 24             Male
## 5   10   3   9000       0 - 6       15 - 24             Male
## 6   11   3  12000       0 - 6       15 - 24             Male
## 7    3   4  12000       0 - 6       25 - 44           Female
## 8    4   4  34000       0 - 6       25 - 44           Female
## 9    5   4  10000       0 - 6       25 - 44           Female
## 10   6   4  11000       0 - 6       25 - 44           Female
## 11   7   4   5000       0 - 6       25 - 44           Female
## 12   8   4   9000       0 - 6       25 - 44             Male
## 13   9   4  31000       0 - 6       25 - 44             Male
## 14  10   4   8000       0 - 6       25 - 44             Male
## 15  11   4  21000       0 - 6       25 - 44             Male
## 16  12   4   7000       0 - 6       25 - 44             Male
## 17   3   5  10000       0 - 6       45 - 64           Female
## 18   4   5  30000       0 - 6       45 - 64           Female
## 19   5   5   6000       0 - 6       45 - 64           Female
## 20   6   5  19000       0 - 6       45 - 64           Female
## 21   7   5   6000       0 - 6       45 - 64           Female
## 22   8   5   7000       0 - 6       45 - 64             Male
## 23   9   5  23000       0 - 6       45 - 64             Male
## 24  10   5   5000       0 - 6       45 - 64             Male
## 25  11   5  17000       0 - 6       45 - 64             Male
## 26  12   5   6000       0 - 6       45 - 64             Male
## 27   3   6  27000      7 - 10       15 - 24           Female
## 28   4   6 161000      7 - 10       15 - 24           Female
## 29   5   6  14000      7 - 10       15 - 24           Female
## 30   6   6  43000      7 - 10       15 - 24           Female
## 31   7   6   6000      7 - 10       15 - 24           Female
## 32   8   6  13000      7 - 10       15 - 24             Male
## 33   9   6 190000      7 - 10       15 - 24             Male
## 34  10   6  11000      7 - 10       15 - 24             Male
## 35  11   6  37000      7 - 10       15 - 24             Male
## 36   3   7 137000      7 - 10       25 - 44           Female
## 37   4   7 179000      7 - 10       25 - 44           Female
## 38   5   7  66000      7 - 10       25 - 44           Female
## 39   6   7  36000      7 - 10       25 - 44           Female
## 40   7   7  86000      7 - 10       25 - 44           Female
## 41   8   7  81000      7 - 10       25 - 44             Male
## 42   9   7 219000      7 - 10       25 - 44             Male
## 43  10   7  47000      7 - 10       25 - 44             Male
## 44  11   7  50000      7 - 10       25 - 44             Male
## 45  12   7  60000      7 - 10       25 - 44             Male
## 46   3   8  64000      7 - 10       45 - 64           Female
## 47   4   8 210000      7 - 10       45 - 64           Female
## 48   5   8  68000      7 - 10       45 - 64           Female
## 49   6   8  91000      7 - 10       45 - 64           Female
## 50   7   8  55000      7 - 10       45 - 64           Female
## 51   8   8  66000      7 - 10       45 - 64             Male
## 52   9   8 199000      7 - 10       45 - 64             Male
## 53  10   8  58000      7 - 10       45 - 64             Male
## 54  11   8  75000      7 - 10       45 - 64             Male
## 55  12   8  68000      7 - 10       45 - 64             Male
##          header.header.header
## 1           Bachelor's degree
## 2                 Certificate
## 3            No Qualification
## 4                 Certificate
## 5                     Diploma
## 6            No Qualification
## 7           Bachelor's degree
## 8                 Certificate
## 9                     Diploma
## 10           No Qualification
## 11 Postgraduate qualification
## 12          Bachelor's degree
## 13                Certificate
## 14                    Diploma
## 15           No Qualification
## 16 Postgraduate qualification
## 17          Bachelor's degree
## 18                Certificate
## 19                    Diploma
## 20           No Qualification
## 21 Postgraduate qualification
## 22          Bachelor's degree
## 23                Certificate
## 24                    Diploma
## 25           No Qualification
## 26 Postgraduate qualification
## 27          Bachelor's degree
## 28                Certificate
## 29                    Diploma
## 30           No Qualification
## 31 Postgraduate qualification
## 32          Bachelor's degree
## 33                Certificate
## 34                    Diploma
## 35           No Qualification
## 36          Bachelor's degree
## 37                Certificate
## 38                    Diploma
## 39           No Qualification
## 40 Postgraduate qualification
## 41          Bachelor's degree
## 42                Certificate
## 43                    Diploma
## 44           No Qualification
## 45 Postgraduate qualification
## 46          Bachelor's degree
## 47                Certificate
## 48                    Diploma
## 49           No Qualification
## 50 Postgraduate qualification
## 51          Bachelor's degree
## 52                Certificate
## 53                    Diploma
## 54           No Qualification
## 55 Postgraduate qualification</code></pre>
<pre class="sourceCode r" id="cb71"><code class="sourceCode r"><div class="sourceLine" id="cb71-1" data-line-number="1">ABOVE_LEFT &lt;-<span class="st"> </span>datacells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(row, col)</div></code></pre>
</div>
</div>
<div id="below-right-example" class="section level2">
<h2 class="hasAnchor">
<a href="#below-right-example" class="anchor"></a>BELOW RIGHT example</h2>
<pre class="sourceCode r" id="cb72"><code class="sourceCode r"><div class="sourceLine" id="cb72-1" data-line-number="1">cells &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tidy_table.html">tidy_table</a></span>(purpose<span class="op">$</span><span class="st">`</span><span class="dt">BELOW RIGHT</span><span class="st">`</span>)</div></code></pre>
<div id="headers-3" class="section level3">
<h3 class="hasAnchor">
<a href="#headers-3" class="anchor"></a>Headers</h3>
<pre class="sourceCode r" id="cb73"><code class="sourceCode r"><div class="sourceLine" id="cb73-1" data-line-number="1">row_headers &lt;-</div>
<div class="sourceLine" id="cb73-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb73-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb73-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb73-5" data-line-number="5">
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)</div>
<div class="sourceLine" id="cb73-6" data-line-number="6">row_headers</div></code></pre>
<pre><code>## $`7`
## # A tibble: 10 x 3
##      row   col header                    
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;                     
##  1     1     7 Bachelor's degree         
##  2     2     7 Certificate               
##  3     3     7 Diploma                   
##  4     4     7 No Qualification          
##  5     5     7 Postgraduate qualification
##  6     6     7 Bachelor's degree         
##  7     7     7 Certificate               
##  8     8     7 Diploma                   
##  9     9     7 No Qualification          
## 10    10     7 Postgraduate qualification
## 
## $`8`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     3     8 Female
## 2     8     8 Male</code></pre>
<pre class="sourceCode r" id="cb75"><code class="sourceCode r"><div class="sourceLine" id="cb75-1" data-line-number="1">col_headers &lt;-</div>
<div class="sourceLine" id="cb75-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb75-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">11</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb75-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb75-5" data-line-number="5">
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)</div>
<div class="sourceLine" id="cb75-6" data-line-number="6">col_headers</div></code></pre>
<pre><code>## $`11`
## # A tibble: 6 x 3
##     row   col header 
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
## 1    11     1 15 - 24
## 2    11     2 25 - 44
## 3    11     3 45 - 64
## 4    11     4 15 - 24
## 5    11     5 25 - 44
## 6    11     6 45 - 64
## 
## $`12`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1    12     2 0 - 6 
## 2    12     5 7 - 10</code></pre>
</div>
<div id="data-3" class="section level3">
<h3 class="hasAnchor">
<a href="#data-3" class="anchor"></a>Data</h3>
<pre class="sourceCode r" id="cb77"><code class="sourceCode r"><div class="sourceLine" id="cb77-1" data-line-number="1">datacells &lt;-</div>
<div class="sourceLine" id="cb77-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb77-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>, col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">6</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb77-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(chr)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb77-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, value)</div>
<div class="sourceLine" id="cb77-6" data-line-number="6">datacells</div></code></pre>
<pre><code>## # A tibble: 55 x 3
##      row   col value
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1     1     1  7000
##  2     2     1 29000
##  3     4     1 10000
##  4     7     1 30000
##  5     8     1  9000
##  6     9     1 12000
##  7     1     2 12000
##  8     2     2 34000
##  9     3     2 10000
## 10     4     2 11000
## # ... with 45 more rows</code></pre>
</div>
<div id="join-headers-to-data-4" class="section level3">
<h3 class="hasAnchor">
<a href="#join-headers-to-data-4" class="anchor"></a>Join headers to data</h3>
<pre class="sourceCode r" id="cb79"><code class="sourceCode r"><div class="sourceLine" id="cb79-1" data-line-number="1">datacells &lt;-</div>
<div class="sourceLine" id="cb79-2" data-line-number="2">
<span class="st">  </span>datacells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb79-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">BELOW</a></span>(col_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb79-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">S</a></span>(col_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb79-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">RIGHT</a></span>(row_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb79-6" data-line-number="6">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">E</a></span>(row_headers[[<span class="dv">1</span>]])</div></code></pre>
</div>
<div id="result-5" class="section level3">
<h3 class="hasAnchor">
<a href="#result-5" class="anchor"></a>Result</h3>
<pre class="sourceCode r" id="cb80"><code class="sourceCode r"><div class="sourceLine" id="cb80-1" data-line-number="1">datacells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</div></code></pre>
<pre><code>##    row col  value header.data header.header header.data.data
## 1    1   1   7000       0 - 6       15 - 24           Female
## 2    2   1  29000       0 - 6       15 - 24           Female
## 3    4   1  10000       0 - 6       15 - 24           Female
## 4    7   1  30000       0 - 6       15 - 24             Male
## 5    8   1   9000       0 - 6       15 - 24             Male
## 6    9   1  12000       0 - 6       15 - 24             Male
## 7    1   2  12000       0 - 6       25 - 44           Female
## 8    2   2  34000       0 - 6       25 - 44           Female
## 9    3   2  10000       0 - 6       25 - 44           Female
## 10   4   2  11000       0 - 6       25 - 44           Female
## 11   5   2   5000       0 - 6       25 - 44           Female
## 12   6   2   9000       0 - 6       25 - 44             Male
## 13   7   2  31000       0 - 6       25 - 44             Male
## 14   8   2   8000       0 - 6       25 - 44             Male
## 15   9   2  21000       0 - 6       25 - 44             Male
## 16  10   2   7000       0 - 6       25 - 44             Male
## 17   1   3  10000       0 - 6       45 - 64           Female
## 18   2   3  30000       0 - 6       45 - 64           Female
## 19   3   3   6000       0 - 6       45 - 64           Female
## 20   4   3  19000       0 - 6       45 - 64           Female
## 21   5   3   6000       0 - 6       45 - 64           Female
## 22   6   3   7000       0 - 6       45 - 64             Male
## 23   7   3  23000       0 - 6       45 - 64             Male
## 24   8   3   5000       0 - 6       45 - 64             Male
## 25   9   3  17000       0 - 6       45 - 64             Male
## 26  10   3   6000       0 - 6       45 - 64             Male
## 27   1   4  27000      7 - 10       15 - 24           Female
## 28   2   4 161000      7 - 10       15 - 24           Female
## 29   3   4  14000      7 - 10       15 - 24           Female
## 30   4   4  43000      7 - 10       15 - 24           Female
## 31   5   4   6000      7 - 10       15 - 24           Female
## 32   6   4  13000      7 - 10       15 - 24             Male
## 33   7   4 190000      7 - 10       15 - 24             Male
## 34   8   4  11000      7 - 10       15 - 24             Male
## 35   9   4  37000      7 - 10       15 - 24             Male
## 36   1   5 137000      7 - 10       25 - 44           Female
## 37   2   5 179000      7 - 10       25 - 44           Female
## 38   3   5  66000      7 - 10       25 - 44           Female
## 39   4   5  36000      7 - 10       25 - 44           Female
## 40   5   5  86000      7 - 10       25 - 44           Female
## 41   6   5  81000      7 - 10       25 - 44             Male
## 42   7   5 219000      7 - 10       25 - 44             Male
## 43   8   5  47000      7 - 10       25 - 44             Male
## 44   9   5  50000      7 - 10       25 - 44             Male
## 45  10   5  60000      7 - 10       25 - 44             Male
## 46   1   6  64000      7 - 10       45 - 64           Female
## 47   2   6 210000      7 - 10       45 - 64           Female
## 48   3   6  68000      7 - 10       45 - 64           Female
## 49   4   6  91000      7 - 10       45 - 64           Female
## 50   5   6  55000      7 - 10       45 - 64           Female
## 51   6   6  66000      7 - 10       45 - 64             Male
## 52   7   6 199000      7 - 10       45 - 64             Male
## 53   8   6  58000      7 - 10       45 - 64             Male
## 54   9   6  75000      7 - 10       45 - 64             Male
## 55  10   6  68000      7 - 10       45 - 64             Male
##          header.header.header
## 1           Bachelor's degree
## 2                 Certificate
## 3            No Qualification
## 4                 Certificate
## 5                     Diploma
## 6            No Qualification
## 7           Bachelor's degree
## 8                 Certificate
## 9                     Diploma
## 10           No Qualification
## 11 Postgraduate qualification
## 12          Bachelor's degree
## 13                Certificate
## 14                    Diploma
## 15           No Qualification
## 16 Postgraduate qualification
## 17          Bachelor's degree
## 18                Certificate
## 19                    Diploma
## 20           No Qualification
## 21 Postgraduate qualification
## 22          Bachelor's degree
## 23                Certificate
## 24                    Diploma
## 25           No Qualification
## 26 Postgraduate qualification
## 27          Bachelor's degree
## 28                Certificate
## 29                    Diploma
## 30           No Qualification
## 31 Postgraduate qualification
## 32          Bachelor's degree
## 33                Certificate
## 34                    Diploma
## 35           No Qualification
## 36          Bachelor's degree
## 37                Certificate
## 38                    Diploma
## 39           No Qualification
## 40 Postgraduate qualification
## 41          Bachelor's degree
## 42                Certificate
## 43                    Diploma
## 44           No Qualification
## 45 Postgraduate qualification
## 46          Bachelor's degree
## 47                Certificate
## 48                    Diploma
## 49           No Qualification
## 50 Postgraduate qualification
## 51          Bachelor's degree
## 52                Certificate
## 53                    Diploma
## 54           No Qualification
## 55 Postgraduate qualification</code></pre>
<pre class="sourceCode r" id="cb82"><code class="sourceCode r"><div class="sourceLine" id="cb82-1" data-line-number="1">BELOW_RIGHT &lt;-<span class="st"> </span>datacells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(row, col)</div></code></pre>
</div>
</div>
<div id="check-that-all-sheets-are-parsed-correctly-1" class="section level2">
<h2 class="hasAnchor">
<a href="#check-that-all-sheets-are-parsed-correctly-1" class="anchor"></a>Check that all sheets are parsed correctly</h2>
<pre class="sourceCode r" id="cb83"><code class="sourceCode r"><div class="sourceLine" id="cb83-1" data-line-number="1">
<span class="kw">identical</span>(ABOVE_LEFT[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>], BELOW_RIGHT[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>])</div></code></pre>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="above-left-border-example" class="section level2">
<h2 class="hasAnchor">
<a href="#above-left-border-example" class="anchor"></a>ABOVE LEFT border example</h2>
<pre class="sourceCode r" id="cb85"><code class="sourceCode r"><div class="sourceLine" id="cb85-1" data-line-number="1">spreadsheet &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata/purpose.xlsx"</span>, <span class="dt">package =</span> <span class="st">"unpivotr"</span>)</div>
<div class="sourceLine" id="cb85-2" data-line-number="2">cells &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyxl/topics/tidy_xlsx">tidy_xlsx</a></span>(spreadsheet, <span class="st">"ABOVE LEFT border"</span>)<span class="op">$</span>data[[<span class="dv">1</span>]]</div></code></pre>
<pre><code>## Warning: 'tidy_xlsx()' is deprecated.
## Use 'xlsx_cells()' or 'xlsx_formats()' instead.</code></pre>
<div id="headers-4" class="section level3">
<h3 class="hasAnchor">
<a href="#headers-4" class="anchor"></a>Headers</h3>
<pre class="sourceCode r" id="cb87"><code class="sourceCode r"><div class="sourceLine" id="cb87-1" data-line-number="1"><span class="co"># Same as ABOVE LEFT without borders</span></div>
<div class="sourceLine" id="cb87-2" data-line-number="2">row_headers &lt;-</div>
<div class="sourceLine" id="cb87-3" data-line-number="3">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb87-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="op">!</span>is_blank) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb87-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb87-6" data-line-number="6">
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)</div>
<div class="sourceLine" id="cb87-7" data-line-number="7">row_headers</div></code></pre>
<pre><code>## $`2`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     5     2 Female
## 2    10     2 Male  
## 
## $`3`
## # A tibble: 10 x 3
##      row   col header                    
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;                     
##  1     4     3 Bachelor's degree         
##  2     5     3 Certificate               
##  3     6     3 Diploma                   
##  4     7     3 No Qualification          
##  5     8     3 Postgraduate qualification
##  6     9     3 Bachelor's degree         
##  7    10     3 Certificate               
##  8    11     3 Diploma                   
##  9    12     3 No Qualification          
## 10    13     3 Postgraduate qualification</code></pre>
<pre class="sourceCode r" id="cb89"><code class="sourceCode r"><div class="sourceLine" id="cb89-1" data-line-number="1">col_headers &lt;-</div>
<div class="sourceLine" id="cb89-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb89-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="op">!</span>is_blank) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb89-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb89-5" data-line-number="5">
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)</div>
<div class="sourceLine" id="cb89-6" data-line-number="6">col_headers</div></code></pre>
<pre><code>## $`2`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     2     6 0 - 6 
## 2     2     8 7 - 10
## 
## $`3`
## # A tibble: 6 x 3
##     row   col header 
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
## 1     3     4 15 - 24
## 2     3     5 25 - 44
## 3     3     6 45 - 64
## 4     3     7 15 - 24
## 5     3     8 25 - 44
## 6     3     9 45 - 64</code></pre>
</div>
<div id="data-4" class="section level3">
<h3 class="hasAnchor">
<a href="#data-4" class="anchor"></a>Data</h3>
<pre class="sourceCode r" id="cb91"><code class="sourceCode r"><div class="sourceLine" id="cb91-1" data-line-number="1"><span class="co"># Same as ABOVE LEFT without borders</span></div>
<div class="sourceLine" id="cb91-2" data-line-number="2">datacells &lt;-</div>
<div class="sourceLine" id="cb91-3" data-line-number="3">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb91-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">4</span>, col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">4</span>, <span class="op">!</span>is_blank) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb91-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">content =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(character), numeric, <span class="ot">NA</span>)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb91-6" data-line-number="6">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(content)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb91-7" data-line-number="7">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, value)</div>
<div class="sourceLine" id="cb91-8" data-line-number="8">datacells</div></code></pre>
<pre><code>## # A tibble: 55 x 3
##      row   col  value
##    &lt;int&gt; &lt;int&gt;  &lt;int&gt;
##  1     4     4   7000
##  2     4     5  12000
##  3     4     6  10000
##  4     4     7  27000
##  5     4     8 137000
##  6     4     9  64000
##  7     5     4  29000
##  8     5     5  34000
##  9     5     6  30000
## 10     5     7 161000
## # ... with 45 more rows</code></pre>
</div>
<div id="borders" class="section level3">
<h3 class="hasAnchor">
<a href="#borders" class="anchor"></a>Borders</h3>
<pre class="sourceCode r" id="cb93"><code class="sourceCode r"><div class="sourceLine" id="cb93-1" data-line-number="1"><span class="co"># Different from ABOVE LEFT without borders</span></div>
<div class="sourceLine" id="cb93-2" data-line-number="2"><span class="co"># Find cells with borders on the bottom, and ones with borders on the left</span></div>
<div class="sourceLine" id="cb93-3" data-line-number="3">formatting &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyxl/topics/tidy_xlsx">tidy_xlsx</a></span>(spreadsheet)<span class="op">$</span>formats</div></code></pre>
<pre><code>## Warning: 'tidy_xlsx()' is deprecated.
## Use 'xlsx_cells()' or 'xlsx_formats()' instead.</code></pre>
<pre class="sourceCode r" id="cb95"><code class="sourceCode r"><div class="sourceLine" id="cb95-1" data-line-number="1">left_borders &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(formatting<span class="op">$</span>local<span class="op">$</span>border<span class="op">$</span>left<span class="op">$</span>style))</div>
<div class="sourceLine" id="cb95-2" data-line-number="2">top_borders &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(formatting<span class="op">$</span>local<span class="op">$</span>border<span class="op">$</span>top<span class="op">$</span>style))</div>
<div class="sourceLine" id="cb95-3" data-line-number="3"></div>
<div class="sourceLine" id="cb95-4" data-line-number="4">left_border_cells &lt;-</div>
<div class="sourceLine" id="cb95-5" data-line-number="5">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb95-6" data-line-number="6">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, local_format_id <span class="op">%in%</span><span class="st"> </span>left_borders) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb95-7" data-line-number="7">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col)</div>
<div class="sourceLine" id="cb95-8" data-line-number="8">top_border_cells &lt;-</div>
<div class="sourceLine" id="cb95-9" data-line-number="9">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb95-10" data-line-number="10">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(col <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, local_format_id <span class="op">%in%</span><span class="st"> </span>top_borders) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb95-11" data-line-number="11">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col)</div></code></pre>
</div>
<div id="join-headers-to-data-5" class="section level3">
<h3 class="hasAnchor">
<a href="#join-headers-to-data-5" class="anchor"></a>Join headers to data</h3>
<pre class="sourceCode r" id="cb96"><code class="sourceCode r"><div class="sourceLine" id="cb96-1" data-line-number="1">datacells &lt;-</div>
<div class="sourceLine" id="cb96-2" data-line-number="2">
<span class="st">  </span>datacells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb96-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">ABOVE</a></span>(col_headers[[<span class="dv">1</span>]], left_border_cells) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from ABOVE LEFT</span>
</div>
<div class="sourceLine" id="cb96-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">N</a></span>(col_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Same as ABOVE LEFT</span>
</div>
<div class="sourceLine" id="cb96-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">LEFT</a></span>(row_headers[[<span class="dv">1</span>]], top_border_cells) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from ABOVE LEFT</span>
</div>
<div class="sourceLine" id="cb96-6" data-line-number="6">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">W</a></span>(row_headers[[<span class="dv">2</span>]]) <span class="co"># Same as ABOVE LEFT</span>
</div></code></pre>
</div>
<div id="result-6" class="section level3">
<h3 class="hasAnchor">
<a href="#result-6" class="anchor"></a>Result</h3>
<pre class="sourceCode r" id="cb97"><code class="sourceCode r"><div class="sourceLine" id="cb97-1" data-line-number="1">datacells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</div></code></pre>
<pre><code>##    row col  value header.data header.header header.data.data
## 1    4   4   7000       0 - 6       15 - 24           Female
## 2    4   5  12000       0 - 6       25 - 44           Female
## 3    4   6  10000       0 - 6       45 - 64           Female
## 4    4   7  27000      7 - 10       15 - 24           Female
## 5    4   8 137000      7 - 10       25 - 44           Female
## 6    4   9  64000      7 - 10       45 - 64           Female
## 7    5   4  29000       0 - 6       15 - 24           Female
## 8    5   5  34000       0 - 6       25 - 44           Female
## 9    5   6  30000       0 - 6       45 - 64           Female
## 10   5   7 161000      7 - 10       15 - 24           Female
## 11   5   8 179000      7 - 10       25 - 44           Female
## 12   5   9 210000      7 - 10       45 - 64           Female
## 13   6   5  10000       0 - 6       25 - 44           Female
## 14   6   6   6000       0 - 6       45 - 64           Female
## 15   6   7  14000      7 - 10       15 - 24           Female
## 16   6   8  66000      7 - 10       25 - 44           Female
## 17   6   9  68000      7 - 10       45 - 64           Female
## 18   7   4  10000       0 - 6       15 - 24           Female
## 19   7   5  11000       0 - 6       25 - 44           Female
## 20   7   6  19000       0 - 6       45 - 64           Female
## 21   7   7  43000      7 - 10       15 - 24           Female
## 22   7   8  36000      7 - 10       25 - 44           Female
## 23   7   9  91000      7 - 10       45 - 64           Female
## 24   8   5   5000       0 - 6       25 - 44           Female
## 25   8   6   6000       0 - 6       45 - 64           Female
## 26   8   7   6000      7 - 10       15 - 24           Female
## 27   8   8  86000      7 - 10       25 - 44           Female
## 28   8   9  55000      7 - 10       45 - 64           Female
## 29   9   5   9000       0 - 6       25 - 44             Male
## 30   9   6   7000       0 - 6       45 - 64             Male
## 31   9   7  13000      7 - 10       15 - 24             Male
## 32   9   8  81000      7 - 10       25 - 44             Male
## 33   9   9  66000      7 - 10       45 - 64             Male
## 34  10   4  30000       0 - 6       15 - 24             Male
## 35  10   5  31000       0 - 6       25 - 44             Male
## 36  10   6  23000       0 - 6       45 - 64             Male
## 37  10   7 190000      7 - 10       15 - 24             Male
## 38  10   8 219000      7 - 10       25 - 44             Male
## 39  10   9 199000      7 - 10       45 - 64             Male
## 40  11   4   9000       0 - 6       15 - 24             Male
## 41  11   5   8000       0 - 6       25 - 44             Male
## 42  11   6   5000       0 - 6       45 - 64             Male
## 43  11   7  11000      7 - 10       15 - 24             Male
## 44  11   8  47000      7 - 10       25 - 44             Male
## 45  11   9  58000      7 - 10       45 - 64             Male
## 46  12   4  12000       0 - 6       15 - 24             Male
## 47  12   5  21000       0 - 6       25 - 44             Male
## 48  12   6  17000       0 - 6       45 - 64             Male
## 49  12   7  37000      7 - 10       15 - 24             Male
## 50  12   8  50000      7 - 10       25 - 44             Male
## 51  12   9  75000      7 - 10       45 - 64             Male
## 52  13   5   7000       0 - 6       25 - 44             Male
## 53  13   6   6000       0 - 6       45 - 64             Male
## 54  13   8  60000      7 - 10       25 - 44             Male
## 55  13   9  68000      7 - 10       45 - 64             Male
##          header.header.header
## 1           Bachelor's degree
## 2           Bachelor's degree
## 3           Bachelor's degree
## 4           Bachelor's degree
## 5           Bachelor's degree
## 6           Bachelor's degree
## 7                 Certificate
## 8                 Certificate
## 9                 Certificate
## 10                Certificate
## 11                Certificate
## 12                Certificate
## 13                    Diploma
## 14                    Diploma
## 15                    Diploma
## 16                    Diploma
## 17                    Diploma
## 18           No Qualification
## 19           No Qualification
## 20           No Qualification
## 21           No Qualification
## 22           No Qualification
## 23           No Qualification
## 24 Postgraduate qualification
## 25 Postgraduate qualification
## 26 Postgraduate qualification
## 27 Postgraduate qualification
## 28 Postgraduate qualification
## 29          Bachelor's degree
## 30          Bachelor's degree
## 31          Bachelor's degree
## 32          Bachelor's degree
## 33          Bachelor's degree
## 34                Certificate
## 35                Certificate
## 36                Certificate
## 37                Certificate
## 38                Certificate
## 39                Certificate
## 40                    Diploma
## 41                    Diploma
## 42                    Diploma
## 43                    Diploma
## 44                    Diploma
## 45                    Diploma
## 46           No Qualification
## 47           No Qualification
## 48           No Qualification
## 49           No Qualification
## 50           No Qualification
## 51           No Qualification
## 52 Postgraduate qualification
## 53 Postgraduate qualification
## 54 Postgraduate qualification
## 55 Postgraduate qualification</code></pre>
<pre class="sourceCode r" id="cb99"><code class="sourceCode r"><div class="sourceLine" id="cb99-1" data-line-number="1">ABOVE_LEFT_borders &lt;-<span class="st"> </span>datacells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(row, col)</div></code></pre>
</div>
</div>
<div id="below-right-border-example" class="section level2">
<h2 class="hasAnchor">
<a href="#below-right-border-example" class="anchor"></a>BELOW RIGHT border example</h2>
<pre class="sourceCode r" id="cb100"><code class="sourceCode r"><div class="sourceLine" id="cb100-1" data-line-number="1">cells &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyxl/topics/tidy_xlsx">tidy_xlsx</a></span>(spreadsheet, <span class="st">"BELOW RIGHT border"</span>)<span class="op">$</span>data[[<span class="dv">1</span>]]</div></code></pre>
<pre><code>## Warning: 'tidy_xlsx()' is deprecated.
## Use 'xlsx_cells()' or 'xlsx_formats()' instead.</code></pre>
<div id="headers-5" class="section level3">
<h3 class="hasAnchor">
<a href="#headers-5" class="anchor"></a>Headers</h3>
<pre class="sourceCode r" id="cb102"><code class="sourceCode r"><div class="sourceLine" id="cb102-1" data-line-number="1"><span class="co"># Same as BELOW RIGHT without borders</span></div>
<div class="sourceLine" id="cb102-2" data-line-number="2">row_headers &lt;-</div>
<div class="sourceLine" id="cb102-3" data-line-number="3">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb102-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">10</span>, <span class="op">!</span>is_blank) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb102-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb102-6" data-line-number="6">
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)</div>
<div class="sourceLine" id="cb102-7" data-line-number="7">row_headers</div></code></pre>
<pre><code>## $`10`
## # A tibble: 10 x 3
##      row   col header                    
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;                     
##  1     4    10 Bachelor's degree         
##  2     5    10 Certificate               
##  3     6    10 Diploma                   
##  4     7    10 No Qualification          
##  5     8    10 Postgraduate qualification
##  6     9    10 Bachelor's degree         
##  7    10    10 Certificate               
##  8    11    10 Diploma                   
##  9    12    10 No Qualification          
## 10    13    10 Postgraduate qualification
## 
## $`11`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     7    11 Female
## 2    10    11 Male</code></pre>
<pre class="sourceCode r" id="cb104"><code class="sourceCode r"><div class="sourceLine" id="cb104-1" data-line-number="1">col_headers &lt;-</div>
<div class="sourceLine" id="cb104-2" data-line-number="2">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb104-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">14</span>, <span class="op">!</span>is_blank) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb104-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb104-5" data-line-number="5">
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)</div>
<div class="sourceLine" id="cb104-6" data-line-number="6">col_headers</div></code></pre>
<pre><code>## $`14`
## # A tibble: 6 x 3
##     row   col header 
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
## 1    14     4 15 - 24
## 2    14     5 25 - 44
## 3    14     6 45 - 64
## 4    14     7 15 - 24
## 5    14     8 25 - 44
## 6    14     9 45 - 64
## 
## $`15`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1    15     6 0 - 6 
## 2    15     7 7 - 10</code></pre>
</div>
<div id="data-5" class="section level3">
<h3 class="hasAnchor">
<a href="#data-5" class="anchor"></a>Data</h3>
<pre class="sourceCode r" id="cb106"><code class="sourceCode r"><div class="sourceLine" id="cb106-1" data-line-number="1"><span class="co"># Same as BELOW RIGHT without borders</span></div>
<div class="sourceLine" id="cb106-2" data-line-number="2">datacells &lt;-</div>
<div class="sourceLine" id="cb106-3" data-line-number="3">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb106-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">13</span>, col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">9</span>, <span class="op">!</span>is_blank) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb106-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">content =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(character), numeric, <span class="ot">NA</span>)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb106-6" data-line-number="6">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(content)) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb106-7" data-line-number="7">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col, value)</div>
<div class="sourceLine" id="cb106-8" data-line-number="8">datacells</div></code></pre>
<pre><code>## # A tibble: 55 x 3
##      row   col  value
##    &lt;int&gt; &lt;int&gt;  &lt;int&gt;
##  1     4     4   7000
##  2     4     5  12000
##  3     4     6  10000
##  4     4     7  27000
##  5     4     8 137000
##  6     4     9  64000
##  7     5     4  29000
##  8     5     5  34000
##  9     5     6  30000
## 10     5     7 161000
## # ... with 45 more rows</code></pre>
</div>
<div id="borders-1" class="section level3">
<h3 class="hasAnchor">
<a href="#borders-1" class="anchor"></a>Borders</h3>
<pre class="sourceCode r" id="cb108"><code class="sourceCode r"><div class="sourceLine" id="cb108-1" data-line-number="1"><span class="co"># Different from BELOW RIGHT without borders</span></div>
<div class="sourceLine" id="cb108-2" data-line-number="2"><span class="co"># Find cells with borders on the bottom, and ones with borders on the left</span></div>
<div class="sourceLine" id="cb108-3" data-line-number="3">formatting &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyxl/topics/tidy_xlsx">tidy_xlsx</a></span>(spreadsheet)<span class="op">$</span>formats</div></code></pre>
<pre><code>## Warning: 'tidy_xlsx()' is deprecated.
## Use 'xlsx_cells()' or 'xlsx_formats()' instead.</code></pre>
<pre class="sourceCode r" id="cb110"><code class="sourceCode r"><div class="sourceLine" id="cb110-1" data-line-number="1">left_borders &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(formatting<span class="op">$</span>local<span class="op">$</span>border<span class="op">$</span>left<span class="op">$</span>style))</div>
<div class="sourceLine" id="cb110-2" data-line-number="2">top_borders &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(formatting<span class="op">$</span>local<span class="op">$</span>border<span class="op">$</span>top<span class="op">$</span>style))</div>
<div class="sourceLine" id="cb110-3" data-line-number="3"></div>
<div class="sourceLine" id="cb110-4" data-line-number="4">left_border_cells &lt;-</div>
<div class="sourceLine" id="cb110-5" data-line-number="5">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb110-6" data-line-number="6">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(row <span class="op">==</span><span class="st"> </span><span class="dv">15</span>, local_format_id <span class="op">%in%</span><span class="st"> </span>left_borders) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb110-7" data-line-number="7">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col)</div>
<div class="sourceLine" id="cb110-8" data-line-number="8">top_border_cells &lt;-</div>
<div class="sourceLine" id="cb110-9" data-line-number="9">
<span class="st">  </span>cells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb110-10" data-line-number="10">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(col <span class="op">==</span><span class="st"> </span><span class="dv">11</span>, local_format_id <span class="op">%in%</span><span class="st"> </span>top_borders) <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb110-11" data-line-number="11">
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(row, col)</div></code></pre>
</div>
<div id="join-headers-to-data-6" class="section level3">
<h3 class="hasAnchor">
<a href="#join-headers-to-data-6" class="anchor"></a>Join headers to data</h3>
<pre class="sourceCode r" id="cb111"><code class="sourceCode r"><div class="sourceLine" id="cb111-1" data-line-number="1">datacells &lt;-</div>
<div class="sourceLine" id="cb111-2" data-line-number="2">
<span class="st">  </span>datacells <span class="op">%&gt;%</span>
</div>
<div class="sourceLine" id="cb111-3" data-line-number="3">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">BELOW</a></span>(col_headers[[<span class="dv">2</span>]], left_border_cells) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from BELOW RIGHT</span>
</div>
<div class="sourceLine" id="cb111-4" data-line-number="4">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">S</a></span>(col_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Same as BELOW RIGHT</span>
</div>
<div class="sourceLine" id="cb111-5" data-line-number="5">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">RIGHT</a></span>(row_headers[[<span class="dv">2</span>]], top_border_cells) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from BELOW RIGHT</span>
</div>
<div class="sourceLine" id="cb111-6" data-line-number="6">
<span class="st">  </span><span class="kw"><a href="../reference/join_header.html">E</a></span>(row_headers[[<span class="dv">1</span>]]) <span class="co"># Same as BELOW RIGHT</span>
</div></code></pre>
</div>
<div id="result-7" class="section level3">
<h3 class="hasAnchor">
<a href="#result-7" class="anchor"></a>Result</h3>
<pre class="sourceCode r" id="cb112"><code class="sourceCode r"><div class="sourceLine" id="cb112-1" data-line-number="1">datacells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</div></code></pre>
<pre><code>##    row col  value header.data header.header header.data.data
## 1    4   4   7000       0 - 6       15 - 24           Female
## 2    4   5  12000       0 - 6       25 - 44           Female
## 3    4   6  10000       0 - 6       45 - 64           Female
## 4    4   7  27000      7 - 10       15 - 24           Female
## 5    4   8 137000      7 - 10       25 - 44           Female
## 6    4   9  64000      7 - 10       45 - 64           Female
## 7    5   4  29000       0 - 6       15 - 24           Female
## 8    5   5  34000       0 - 6       25 - 44           Female
## 9    5   6  30000       0 - 6       45 - 64           Female
## 10   5   7 161000      7 - 10       15 - 24           Female
## 11   5   8 179000      7 - 10       25 - 44           Female
## 12   5   9 210000      7 - 10       45 - 64           Female
## 13   6   5  10000       0 - 6       25 - 44           Female
## 14   6   6   6000       0 - 6       45 - 64           Female
## 15   6   7  14000      7 - 10       15 - 24           Female
## 16   6   8  66000      7 - 10       25 - 44           Female
## 17   6   9  68000      7 - 10       45 - 64           Female
## 18   7   4  10000       0 - 6       15 - 24           Female
## 19   7   5  11000       0 - 6       25 - 44           Female
## 20   7   6  19000       0 - 6       45 - 64           Female
## 21   7   7  43000      7 - 10       15 - 24           Female
## 22   7   8  36000      7 - 10       25 - 44           Female
## 23   7   9  91000      7 - 10       45 - 64           Female
## 24   8   5   5000       0 - 6       25 - 44           Female
## 25   8   6   6000       0 - 6       45 - 64           Female
## 26   8   7   6000      7 - 10       15 - 24           Female
## 27   8   8  86000      7 - 10       25 - 44           Female
## 28   8   9  55000      7 - 10       45 - 64           Female
## 29   9   5   9000       0 - 6       25 - 44             Male
## 30   9   6   7000       0 - 6       45 - 64             Male
## 31   9   7  13000      7 - 10       15 - 24             Male
## 32   9   8  81000      7 - 10       25 - 44             Male
## 33   9   9  66000      7 - 10       45 - 64             Male
## 34  10   4  30000       0 - 6       15 - 24             Male
## 35  10   5  31000       0 - 6       25 - 44             Male
## 36  10   6  23000       0 - 6       45 - 64             Male
## 37  10   7 190000      7 - 10       15 - 24             Male
## 38  10   8 219000      7 - 10       25 - 44             Male
## 39  10   9 199000      7 - 10       45 - 64             Male
## 40  11   4   9000       0 - 6       15 - 24             Male
## 41  11   5   8000       0 - 6       25 - 44             Male
## 42  11   6   5000       0 - 6       45 - 64             Male
## 43  11   7  11000      7 - 10       15 - 24             Male
## 44  11   8  47000      7 - 10       25 - 44             Male
## 45  11   9  58000      7 - 10       45 - 64             Male
## 46  12   4  12000       0 - 6       15 - 24             Male
## 47  12   5  21000       0 - 6       25 - 44             Male
## 48  12   6  17000       0 - 6       45 - 64             Male
## 49  12   7  37000      7 - 10       15 - 24             Male
## 50  12   8  50000      7 - 10       25 - 44             Male
## 51  12   9  75000      7 - 10       45 - 64             Male
## 52  13   5   7000       0 - 6       25 - 44             Male
## 53  13   6   6000       0 - 6       45 - 64             Male
## 54  13   8  60000      7 - 10       25 - 44             Male
## 55  13   9  68000      7 - 10       45 - 64             Male
##          header.header.header
## 1           Bachelor's degree
## 2           Bachelor's degree
## 3           Bachelor's degree
## 4           Bachelor's degree
## 5           Bachelor's degree
## 6           Bachelor's degree
## 7                 Certificate
## 8                 Certificate
## 9                 Certificate
## 10                Certificate
## 11                Certificate
## 12                Certificate
## 13                    Diploma
## 14                    Diploma
## 15                    Diploma
## 16                    Diploma
## 17                    Diploma
## 18           No Qualification
## 19           No Qualification
## 20           No Qualification
## 21           No Qualification
## 22           No Qualification
## 23           No Qualification
## 24 Postgraduate qualification
## 25 Postgraduate qualification
## 26 Postgraduate qualification
## 27 Postgraduate qualification
## 28 Postgraduate qualification
## 29          Bachelor's degree
## 30          Bachelor's degree
## 31          Bachelor's degree
## 32          Bachelor's degree
## 33          Bachelor's degree
## 34                Certificate
## 35                Certificate
## 36                Certificate
## 37                Certificate
## 38                Certificate
## 39                Certificate
## 40                    Diploma
## 41                    Diploma
## 42                    Diploma
## 43                    Diploma
## 44                    Diploma
## 45                    Diploma
## 46           No Qualification
## 47           No Qualification
## 48           No Qualification
## 49           No Qualification
## 50           No Qualification
## 51           No Qualification
## 52 Postgraduate qualification
## 53 Postgraduate qualification
## 54 Postgraduate qualification
## 55 Postgraduate qualification</code></pre>
<pre class="sourceCode r" id="cb114"><code class="sourceCode r"><div class="sourceLine" id="cb114-1" data-line-number="1">BELOW_RIGHT_borders &lt;-<span class="st"> </span>datacells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(row, col)</div></code></pre>
</div>
</div>
<div id="check-that-all-sheets-are-parsed-correctly-2" class="section level2">
<h2 class="hasAnchor">
<a href="#check-that-all-sheets-are-parsed-correctly-2" class="anchor"></a>Check that all sheets are parsed correctly</h2>
<pre class="sourceCode r" id="cb115"><code class="sourceCode r"><div class="sourceLine" id="cb115-1" data-line-number="1">
<span class="kw">identical</span>(ABOVE_LEFT[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>], BELOW_RIGHT[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>])</div></code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r" id="cb117"><code class="sourceCode r"><div class="sourceLine" id="cb117-1" data-line-number="1">
<span class="kw">identical</span>(ABOVE_LEFT[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>], ABOVE_LEFT_borders[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>])</div></code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r" id="cb119"><code class="sourceCode r"><div class="sourceLine" id="cb119-1" data-line-number="1">
<span class="kw">identical</span>(ABOVE_LEFT[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>], BELOW_RIGHT_borders[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>])</div></code></pre>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#nnw-wnw-example">NNW WNW example</a></li>
      <li><a href="#nne-wsw-example">NNE WSW example</a></li>
      <li><a href="#sse-ese-example">SSE ESE example</a></li>
      <li><a href="#ssw-ene-example">SSW ENE example</a></li>
      <li><a href="#check-that-all-sheets-are-parsed-correctly">Check that all sheets are parsed correctly</a></li>
      <li><a href="#above-left-example">ABOVE LEFT example</a></li>
      <li><a href="#below-right-example">BELOW RIGHT example</a></li>
      <li><a href="#check-that-all-sheets-are-parsed-correctly-1">Check that all sheets are parsed correctly</a></li>
      <li><a href="#above-left-border-example">ABOVE LEFT border example</a></li>
      <li><a href="#below-right-border-example">BELOW RIGHT border example</a></li>
      <li><a href="#check-that-all-sheets-are-parsed-correctly-2">Check that all sheets are parsed correctly</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Duncan Garmonsway.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
